<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Expense Tracker</title>
    <style>
        /* --- Your original CSS (keep all your styles) --- */
        /* Place your original style block here. */

        /* --- Only add this for dark mode --- */
        body.dark-mode {
            background: linear-gradient(135deg, #23253a 0%, #312a45 100%) !important;
            color: #f5f5f5;
        }
        body.dark-mode .container {
            background: rgba(40, 40, 50, 0.96) !important;
            color: #f5f5f5;
        }
        body.dark-mode .header {
            background: linear-gradient(135deg, #312e81, #4c1d95);
            color: #fff;
        }
        body.dark-mode .tab-buttons {
            background: #34345b;
        }
        body.dark-mode .tab-button {
            color: #d1d5db;
        }
        body.dark-mode .tab-button.active {
            background: #3730a3;
            color: #fff;
        }
        body.dark-mode .card {
            background: #27293d;
            color: #f5f5f5;
        }
        body.dark-mode th {
            background: linear-gradient(135deg, #3730a3, #6d28d9);
        }
        body.dark-mode .budget-item.budget {
            background: linear-gradient(135deg, #64748b, #a5b4fc);
        }
        body.dark-mode .budget-item.spent {
            background: linear-gradient(135deg, #f87171, #fbbf24);
        }
        body.dark-mode .budget-item.remaining {
            background: linear-gradient(135deg, #2dd4bf, #818cf8);
        }
        body.dark-mode input,
        body.dark-mode select,
        body.dark-mode textarea {
            background: #18181b;
            color: #fff;
            border-color: #4f46e5;
        }
        body.dark-mode .btn {
            background: linear-gradient(135deg, #3730a3, #6d28d9);
        }
        body.dark-mode .btn:hover {
            background: linear-gradient(135deg, #4c1d95, #6366f1);
        }
        body.dark-mode .btn-danger {
            background: linear-gradient(135deg, #b91c1c, #a21caf);
        }
        body.dark-mode .btn-secondary {
            background: linear-gradient(135deg, #0d9488, #0369a1);
        }
        body.dark-mode .table-container {
            background: #23253a;
        }
        body.dark-mode .budget-progress-bar {
            background-color: #34345b;
        }
        body.dark-mode .budget-progress-fill {
            background: linear-gradient(90deg, #818cf8, #4f46e5);
        }
    </style>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
</head>
<body>
    <div class="container" id="appContent">
        <div class="header">
            <h1 id="headerTitle">ðŸ’° Expense Tracker</h1>
            <button id="themeToggleBtn" style="position: absolute; right: 20px; top: 20px; background: none; border: none; color: #fff; font-size: 1.3rem; cursor: pointer;">ðŸŒ—</button>
            <p id="currentMonthYear"></p>
            <p>Track your expenses and manage your budget efficiently</p>
        </div>

        <div class="tab-buttons">
            <button class="tab-button active" onclick="showTab('dashboardTab')">Dashboard</button>
            <button class="tab-button" onclick="showTab('summaryTab')">Summary</button>
            <button class="tab-button" onclick="showTab('searchTab')">Search</button>
        </div>

        <div id="dashboardTab" class="tab-content active">
            <div class="card">
                <h2><span class="icon">ðŸŽ¯</span> Set Monthly Budget</h2>
                <div class="input-group">
                    <label for="budgetAmount">Budget Amount (â‚¹)</label>
                    <input type="number" id="budgetAmount" placeholder="Enter your monthly budget">
                </div>
                <div class="download-buttons">
                    <button class="btn" id="setBudgetBtn" onclick="setBudget(event)">Set Budget</button>
                    <button class="btn btn-outline" id="resetBudgetBtn" onclick="resetBudget()">Reset Budget</button>
                </div>
                <div class="budget-summary">
                    <div class="budget-item budget">
                        <h3>Budget</h3>
                        <div class="amount" id="budgetDisplay">â‚¹0</div>
                    </div>
                    <div class="budget-item spent">
                        <h3>Total Spent</h3>
                        <div class="amount" id="totalSpent">â‚¹0</div>
                    </div>
                    <div class="budget-item remaining">
                        <h3>Remaining</h3>
                        <div class="amount" id="remaining">â‚¹0</div>
                    </div>
                </div>
                <div class="budget-progress-bar">
                    <div class="budget-progress-fill" id="budgetProgressBarFill"></div>
                    <div class="budget-progress-text" id="budgetProgressBarText">0% Used</div>
                </div>
            </div>

            <div class="card">
                <h2><span class="icon">âž•</span> Add Expense</h2>
                <div class="input-group">
                    <label>Recorded By</label>
                    <div class="radio-group">
                        <label>
                            <input type="radio" name="recordedBy" value="Akshay" checked>
                            Akshay
                        </label>
                        <label>
                            <input type="radio" name="recordedBy" value="Achal">
                            Achal
                        </label>
                    </div>
                </div>
                <div class="input-group">
                    <label for="category">Category</label>
                    <select id="category">
                        <option value="Grocery">Grocery</option>
                        <option value="Bills">Bills</option>
                        <option value="Online shopping">Online shopping</option>
                        <option value="Travelling">Travelling</option>
                        <option value="Food">Food</option>
                        <option value="Medical expenses">Medical expenses</option>
                        <option value="Debt">Debt</option>
                        <option value="Petrol">Petrol</option>
                        <option value="Home expenses other than grocery">Home expenses other than grocery</option>
                        <option value="Maintenance">Maintenance</option>
                        <option value="EMI">EMI</option>
                        <option value="Investment">Investment</option>
                        <option value="Entertainment">Entertainment</option>
                        <option value="Others">Others</option>
                    </select>
                </div>
                <div class="input-group">
                    <label for="vendor">Vendor</label>
                    <input type="text" id="vendor" placeholder="Enter vendor name">
                </div>
                <div class="input-group">
                    <label for="amount">Amount (â‚¹)</label>
                    <input type="number" id="amount" placeholder="Enter amount">
                </div>
                <div class="input-group">
                    <label for="note">Note</label>
                    <textarea id="note" rows="3" placeholder="Add a note (optional)"></textarea>
                </div>
                <button class="btn btn-secondary" id="addExpenseBtn" onclick="addExpense(event)">Add Expense</button>
            </div>

            <div class="card full-width">
                <h2><span class="icon">ðŸ“‹</span> Recent Expenses</h2>
                <div id="recentExpenses"></div>
            </div>
        </div>

        <div id="summaryTab" class="tab-content">
            <div class="card full-width">
                <h2><span class="icon">ðŸ“Š</span> Spending by Category</h2>
                <div class="chart-container">
                    <canvas id="categoryPieChart"></canvas>
                </div>
            </div>
            <div class="stats-grid">
                <div class="card">
                    <h2><span class="icon">ðŸ“ˆ</span> Monthly Spending</h2>
                    <div class="chart-container">
                        <canvas id="monthlyBarChart"></canvas>
                    </div>
                </div>
                <div class="card">
                    <h2><span class="icon">ðŸ“‰</span> Weekly Spending Trend</h2>
                    <div class="chart-container">
                        <canvas id="weeklyBarChart"></canvas>
                    </div>
                </div>
            </div>
            <div class="card full-width">
                <h2><span class="icon">ðŸ”¢</span> Number of Spends by Category</h2>
                <div class="chart-container">
                    <canvas id="categoryCountBarChart"></canvas>
                </div>
            </div>
            <div class="card full-width">
                <h2><span class="icon">ðŸ‘¥</span> Spending by User</h2>
                <div class="chart-container">
                    <canvas id="userSpendingBarChart"></canvas>
                </div>
            </div>
        </div>

        <div id="searchTab" class="tab-content">
            <!-- Your search tab code remains unchanged -->
        </div>
    </div>

    <script>
        // ====== Firebase Initialization ======
        const firebaseConfig = {
            apiKey: "AIzaSyCVcdGryuT",
            authDomain: "monthly-expense-tracke",
            databaseURL: "https://monthly-expense-trackcom",
            projectId: "monthly-expense",
            storageBucket: "monthly-exapp",
            messagingSenderId: "927",
            appId: "1:9276465869",
            measurementId: "G-9"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const fixedUserId = "public_expense_tracker_user";

        // ====== Theme Toggle ======
        const themeBtn = document.getElementById('themeToggleBtn');
        themeBtn.addEventListener('click', () => {
            document.body.classList.toggle('dark-mode');
            localStorage.setItem('expTheme', document.body.classList.contains('dark-mode') ? 'dark' : 'light');
        });
        if(localStorage.getItem('expTheme') === 'dark') {
            document.body.classList.add('dark-mode');
        }

        // ====== Tab Management ======
        function showTab(tabId) {
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(content => content.classList.remove('active'));
            const tabButtons = document.querySelectorAll('.tab-button');
            tabButtons.forEach(button => button.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');
            document.querySelector(`.tab-button[onclick="showTab('${tabId}')"]`).classList.add('active');
            if (tabId === 'dashboardTab') {
                updateBudgetSummary();
                updateBudgetProgressBar();
                updateRecentExpenses();
            } else if (tabId === 'summaryTab') {
                renderCategoryPieChart();
                renderMonthlyBarChart();
                renderWeeklyBarChart();
                renderCategoryCountBarChart();
                renderUserSpendingBarChart();
            }
        }

        // ====== Data Storage ======
        let budget = 0;
        let expenses = [];
        let filteredExpenses = [];
        let categoryPieChartInstance, monthlyBarChartInstance, weeklyBarChartInstance, userSpendingBarChartInstance, categoryCountBarChartInstance;

        document.addEventListener('DOMContentLoaded', () => {
            updateHeaderMonth();
            showTab('dashboardTab');
            Chart.register(ChartDataLabels);
            loadUserData();
        });

        function updateHeaderMonth() {
            const now = new Date();
            const monthNames = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
            document.getElementById('currentMonthYear').textContent = `${monthNames[now.getMonth()]} ${now.getFullYear()}`;
        }

        // ====== Firestore Listeners ======
        function loadUserData() {
            const uid = fixedUserId;
            db.collection('users').doc(uid).collection('budgets').doc('monthly')
                .onSnapshot((doc) => {
                    if (doc.exists) {
                        budget = doc.data().amount || 0;
                        document.getElementById('budgetAmount').value = budget;
                    } else {
                        budget = 0;
                        document.getElementById('budgetAmount').value = '';
                    }
                    updateDisplay();
                });

            db.collection('users').doc(uid).collection('expenses').orderBy('date', 'desc').orderBy('time', 'desc')
                .onSnapshot((snapshot) => {
                    expenses = [];
                    snapshot.forEach((doc) => {
                        expenses.push({ id: doc.id, ...doc.data() });
                    });
                    expenses.sort((a, b) => {
                        const dateA = new Date(a.date + ' ' + a.time);
                        const dateB = new Date(b.date + ' ' + b.time);
                        return dateB - dateA;
                    });
                    updateDisplay();
                });
        }

        // ====== Budget Functions ======
        async function setBudget(event) {
            const uid = fixedUserId;
            const budgetInput = document.getElementById('budgetAmount');
            const newBudget = parseFloat(budgetInput.value);
            const btn = event.target;
            const originalText = btn.textContent;
            if (isNaN(newBudget) || newBudget < 0) {
                alert('Please enter a valid budget amount (0 or greater)');
                return;
            }
            try {
                await db.collection('users').doc(uid).collection('budgets').doc('monthly').set({ amount: newBudget });
                btn.textContent = 'âœ… Budget Set!';
                setTimeout(() => btn.textContent = originalText, 2000);
            } catch (e) {
                alert("Error setting budget: " + e.message);
                btn.textContent = 'âŒ Failed!';
                setTimeout(() => btn.textContent = originalText, 2000);
            }
        }
        async function resetBudget() {
            const uid = fixedUserId;
            if (confirm('Are you sure you want to reset your budget to â‚¹0? This will not affect your expenses.')) {
                try {
                    await db.collection('users').doc(uid).collection('budgets').doc('monthly').set({ amount: 0 });
                } catch (e) {
                    alert("Error resetting budget: " + e.message);
                }
            }
        }

        // ====== Expense Add/Delete ======
        async function addExpense(event) {
            const uid = fixedUserId;
            const recordedBy = document.querySelector('input[name="recordedBy"]:checked').value;
            const category = document.getElementById('category').value;
            const vendor = document.getElementById('vendor').value.trim();
            const amount = parseFloat(document.getElementById('amount').value);
            const note = document.getElementById('note').value.trim();

            if (!category || !vendor || isNaN(amount) || amount <= 0) {
                alert('Please fill in all required fields: Category, Vendor, and a valid Amount.');
                return;
            }
            const btn = event.target;
            btn.disabled = true;
            btn.textContent = 'Adding...';
            btn.classList.add('loading');

            const newExpense = {
                date: new Date().toISOString().split('T')[0],
                time: new Date().toLocaleTimeString('en-US', { hour12: false, hour: '2-digit', minute: '2-digit' }),
                category, vendor, amount, note, recordedBy
            };
            try {
                await db.collection('users').doc(uid).collection('expenses').add(newExpense);
                document.getElementById('vendor').value = '';
                document.getElementById('amount').value = '';
                document.getElementById('note').value = '';
                alert('Expense added successfully!');
            } catch (e) {
                alert("Error adding expense: " + e.message);
            } finally {
                btn.disabled = false;
                btn.textContent = 'Add Expense';
                btn.classList.remove('loading');
            }
        }

        // ====== UI Update Functions ======
        function updateDisplay() {
            updateBudgetSummary();
            updateBudgetProgressBar();
            updateRecentExpenses();
        }
        function updateBudgetSummary() {
            const totalSpent = expenses.reduce((sum, expense) => sum + expense.amount, 0);
            const remaining = budget - totalSpent;
            document.getElementById('budgetDisplay').textContent = `â‚¹${budget.toLocaleString('en-IN')}`;
            document.getElementById('totalSpent').textContent = `â‚¹${totalSpent.toLocaleString('en-IN')}`;
            document.getElementById('remaining').textContent = `â‚¹${remaining.toLocaleString('en-IN')}`;
            document.getElementById('remaining').style.color = (remaining < 0) ? '#dc2626' : '#1f2937';
        }
        function updateBudgetProgressBar() {
            const totalSpent = expenses.reduce((sum, expense) => sum + expense.amount, 0);
            const progressBarFill = document.getElementById('budgetProgressBarFill');
            const progressBarText = document.getElementById('budgetProgressBarText');
            let percentage = budget > 0 ? (totalSpent / budget) * 100 : 0;
            let displayPercentage = Math.min(percentage, 100);
            progressBarFill.style.width = `${displayPercentage}%`;
            let textColor = '#1f2937';
            let bgColor = 'linear-gradient(90deg, #9fe6b0, #7ee793)';
            if (percentage > 75 && percentage <= 100) bgColor = 'linear-gradient(90deg, #fbbf24, #f59e0b)';
            else if (percentage > 100) { bgColor = 'linear-gradient(90deg, #ef4444, #dc2626)'; textColor = '#fff'; }
            progressBarFill.style.background = bgColor;
            progressBarText.style.color = textColor;
            progressBarText.textContent = `${Math.round(percentage)}% Used`;
        }

        function updateRecentExpenses() {
            const recentExpensesDiv = document.getElementById('recentExpenses');
            recentExpensesDiv.innerHTML = '';
            if (expenses.length === 0) {
                recentExpensesDiv.innerHTML = '<p style="text-align: center; color: #6b7280; padding: 20px;">No recent expenses. Add one above!</p>';
                return;
            }
            // Responsive: Table for desktop, cards for mobile
            const isMobile = window.innerWidth <= 768;
            if (isMobile) {
                const mobileCardContainer = document.createElement('div');
                mobileCardContainer.className = 'mobile-expense-card-container';
                expenses.slice(0, 10).forEach(expense => {
                    const card = document.createElement('div');
                    card.className = 'mobile-expense-card';
                    card.innerHTML = `
                        <div class="mobile-expense-card-body">
                            <div class="mobile-expense-card-field"><span class="label">Date:</span><span class="value">${expense.date}</span></div>
                            <div class="mobile-expense-card-field"><span class="label">Owner:</span><span class="value">${expense.recordedBy}</span></div>
                            <div class="mobile-expense-card-field"><span class="label">Category:</span><span class="value">${expense.category}</span></div>
                            <div class="mobile-expense-card-field"><span class="label">Vendor:</span><span class="value">${expense.vendor}</span></div>
                            <div class="mobile-expense-card-field"><span class="label">Amount:</span><span class="value">â‚¹${expense.amount.toLocaleString('en-IN')}</span></div>
                        </div>
                    `;
                    mobileCardContainer.appendChild(card);
                });
                recentExpensesDiv.appendChild(mobileCardContainer);
            } else {
                const tableContainer = document.createElement('div');
                tableContainer.className = 'table-container desktop-table-view';
                const table = document.createElement('table');
                table.innerHTML = `
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Owner</th>
                            <th>Category</th>
                            <th>Vendor</th>
                            <th>Amount (â‚¹)</th>
                        </tr>
                    </thead>
                    <tbody id="recentExpensesTableBody"></tbody>
                `;
                tableContainer.appendChild(table);
                recentExpensesDiv.appendChild(tableContainer);
                const tableBody = table.querySelector('tbody');
                expenses.slice(0, 10).forEach(expense => {
                    const row = tableBody.insertRow();
                    row.innerHTML = `
                        <td>${expense.date}</td>
                        <td>${expense.recordedBy}</td>
                        <td>${expense.category}</td>
                        <td>${expense.vendor}</td>
                        <td>â‚¹${expense.amount.toLocaleString('en-IN')}</td>
                    `;
                });
            }
        }

        // ====== Chart Functions ======
        function renderCategoryPieChart() {
            if (categoryPieChartInstance) categoryPieChartInstance.destroy();
            const categorySpending = expenses.reduce((acc, e) => { acc[e.category] = (acc[e.category] || 0) + e.amount; return acc; }, {});
            const data = {
                labels: Object.keys(categorySpending),
                datasets: [{
                    data: Object.values(categorySpending),
                    backgroundColor: ['#667eea','#764ba2','#38b2ac','#ef4444','#f97316','#eab308','#84cc16','#22c55e','#14b8a6','#06b6d4','#3b82f6','#6366f1','#a855f7','#d946b6'],
                    hoverOffset: 4
                }]
            };
            const ctx = document.getElementById('categoryPieChart').getContext('2d');
            categoryPieChartInstance = new Chart(ctx, {
                type: 'pie',
                data: data,
                options: {
                    plugins: {
                        legend: { position: 'right', labels: { font: { size: 12 } } },
                        datalabels: {
                            color: '#fff',
                            font: { weight: 'bold', size: 16 },
                            formatter: (value, context) => {
                                const total = context.dataset.data.reduce((sum, v) => sum + v, 0);
                                const percentage = ((value / total) * 100).toFixed(1);
                                return percentage > 5 ? `${percentage}%` : '';
                            }
                        }
                    }
                },
                plugins: [ChartDataLabels]
            });
        }

        function renderMonthlyBarChart() {
            if (monthlyBarChartInstance) monthlyBarChartInstance.destroy();
            const monthlySpending = {};
            expenses.forEach(e => {
                const d = new Date(e.date);
                const m = `${d.getFullYear()}-${String(d.getMonth()+1).padStart(2, '0')}`;
                monthlySpending[m] = (monthlySpending[m] || 0) + e.amount;
            });
            const sortedMonths = Object.keys(monthlySpending).sort();
            const data = {
                labels: sortedMonths.map(m => {
                    const [y, mo] = m.split('-');
                    return `${["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][parseInt(mo,10)-1]} '${y.slice(-2)}`;
                }),
                datasets: [{
                    label: 'Amount (â‚¹)',
                    data: sortedMonths.map(m => monthlySpending[m]),
                    backgroundColor: '#667eea',
                }]
            };
            const ctx = document.getElementById('monthlyBarChart').getContext('2d');
            monthlyBarChartInstance = new Chart(ctx, {
                type: 'bar',
                data: data,
                options: {
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: { font: { size: 10 }, callback: v => 'â‚¹'+v.toLocaleString('en-IN') }
                        },
                        x: { ticks: { font: { size: 10 } } }
                    },
                    plugins: {
                        legend: { display: false },
                        datalabels: { color: '#222', anchor: 'end', align: 'top', font: { size: 16, weight: 'bold' }, formatter: v => 'â‚¹'+v.toLocaleString('en-IN') }
                    }
                },
                plugins: [ChartDataLabels]
            });
        }

        function renderWeeklyBarChart() {
            if (weeklyBarChartInstance) weeklyBarChartInstance.destroy();
            // Fixed 4-week split for current month
            const now = new Date();
            const year = now.getFullYear();
            const month = now.getMonth();
            const daysInMonth = new Date(year, month+1, 0).getDate();
            const weekRanges = [
                [1, Math.floor(daysInMonth/4)],
                [Math.floor(daysInMonth/4)+1, Math.floor(daysInMonth/2)],
                [Math.floor(daysInMonth/2)+1, Math.floor(3*daysInMonth/4)],
                [Math.floor(3*daysInMonth/4)+1, daysInMonth]
            ];
            const weekTotals = [0,0,0,0];
            expenses.forEach(e => {
                const d = new Date(e.date);
                if (d.getMonth() === month && d.getFullYear() === year) {
                    for (let i=0; i<4; i++) {
                        if (d.getDate() >= weekRanges[i][0] && d.getDate() <= weekRanges[i][1]) {
                            weekTotals[i] += e.amount;
                            break;
                        }
                    }
                }
            });
            const data = {
                labels: ['Week 1','Week 2','Week 3','Week 4'],
                datasets: [{
                    label: 'Amount (â‚¹)',
                    data: weekTotals,
                    backgroundColor: '#06b6d4'
                }]
            };
            const ctx = document.getElementById('weeklyBarChart').getContext('2d');
            weeklyBarChartInstance = new Chart(ctx, {
                type: 'bar',
                data: data,
                options: {
                    scales: {
                        y: { beginAtZero: true, ticks: { font: { size: 10 }, callback: v => 'â‚¹'+v.toLocaleString('en-IN') } },
                        x: { ticks: { font: { size: 10 } } }
                    },
                    plugins: {
                        legend: { display: false },
                        datalabels: { color: '#222', anchor: 'end', align: 'top', font: { size: 16, weight: 'bold' }, formatter: v => 'â‚¹'+v.toLocaleString('en-IN') }
                    }
                },
                plugins: [ChartDataLabels]
            });
        }

        function renderCategoryCountBarChart() {
            if (categoryCountBarChartInstance) categoryCountBarChartInstance.destroy();
            const categoryCounts = expenses.reduce((acc, e) => { acc[e.category] = (acc[e.category] || 0) + 1; return acc; }, {});
            const data = {
                labels: Object.keys(categoryCounts),
                datasets: [{
                    label: 'Number of Spends',
                    data: Object.values(categoryCounts),
                    backgroundColor: '#a855f7'
                }]
            };
            const ctx = document.getElementById('categoryCountBarChart').getContext('2d');
            categoryCountBarChartInstance = new Chart(ctx, {
                type: 'bar',
                data: data,
                options: {
                    scales: {
                        y: { beginAtZero: true, ticks: { font: { size: 10 }, precision: 0 } },
                        x: { ticks: { font: { size: 10 } } }
                    },
                    plugins: {
                        legend: { display: false },
                        datalabels: { color: '#222', anchor: 'end', align: 'top', font: { size: 16, weight: 'bold' } }
                    }
                },
                plugins: [ChartDataLabels]
            });
        }
        function renderUserSpendingBarChart() {
            if (userSpendingBarChartInstance) userSpendingBarChartInstance.destroy();
            const userSpending = expenses.reduce((acc, e) => { acc[e.recordedBy] = (acc[e.recordedBy] || 0) + e.amount; return acc; }, {});
            const data = {
                labels: Object.keys(userSpending),
                datasets: [{
                    label: 'Amount (â‚¹)',
                    data: Object.values(userSpending),
                    backgroundColor: '#f59e0b'
                }]
            };
            const ctx = document.getElementById('userSpendingBarChart').getContext('2d');
            userSpendingBarChartInstance = new Chart(ctx, {
                type: 'bar',
                data: data,
                options: {
                    scales: {
                        y: { beginAtZero: true, ticks: { font: { size: 10 }, callback: v => 'â‚¹'+v.toLocaleString('en-IN') } },
                        x: { ticks: { font: { size: 10 } } }
                    },
                    plugins: {
                        legend: { display: false },
                        datalabels: { color: '#222', anchor: 'end', align: 'top', font: { size: 16, weight: 'bold' }, formatter: v => 'â‚¹'+v.toLocaleString('en-IN') }
                    }
                },
                plugins: [ChartDataLabels]
            });
        }
    </script>
</body>
</html>
